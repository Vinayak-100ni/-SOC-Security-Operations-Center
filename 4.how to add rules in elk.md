Here‚Äôs the **exact way to add your rule** in Elastic SIEM for:

> **Execution (T1204) : CKYC | P2 | Suspicious URL Communication**

This rule will detect suspicious URL access from CKYC systems.

---

## ‚úÖ Step-1: Go to Rule Creation

In **Kibana**:

```
Security ‚Üí Alerts ‚Üí Rules ‚Üí Create new rule
```

Select:

üëâ **Custom query**

---

## ‚úÖ Step-2: Add the Detection Logic (Query)

Use this **KQL query** to detect suspicious URL communication:

```kql
url.full : ("*.ru" or "*.tk" or "*.top" or "*.xyz") 
or
url.original : ("pastebin.com" or "tinyurl.com" or "bit.ly")
or
process.name : ("powershell.exe" or "curl.exe" or "wget.exe")
```

(You can edit domains based on your threat intel.)

Click **Continue**

---

## ‚úÖ Step-3: Rule Basic Details

Fill like this:

| Field            | Value                                                     |
| ---------------- | --------------------------------------------------------- |
| **Rule name**    | `Execution (T1204) : CKYC - Suspicious URL Communication` |
| **Severity**     | High                                                      |
| **Risk score**   | 75                                                        |
| **Rule Tags**    | `CKYC, Execution, T1204, SuspiciousURL, P2`               |
| **MITRE ATT&CK** | `Execution ‚Üí T1204 - User Execution`                      |

Click **Continue**

---

## ‚úÖ Step-4: Schedule Settings

Configure:

| Setting            | Value                                  |
| ------------------ | -------------------------------------- |
| **Run rule every** | `5 minutes`                            |
| **Look-back time** | `10 minutes`                           |
| **Index patterns** | `logs-* or winlogbeat-* or filebeat-*` |

Click **Continue**

---

## ‚úÖ Step-5: Add Response Action (Optional)

You can add alert actions like:

* ‚úÖ Send Email to SOC team
* ‚úÖ Post to Microsoft Teams / Slack
* ‚úÖ Create Case in Elastic
* ‚úÖ Lock Endpoint (if Elastic Defend enabled)

For now, you can skip or configure later.

Click **Create rule**

Then **TURN ON the rule**.

---

## üìå Final Rule Summary (For your document)

```
Rule Name: Execution (T1204) : CKYC | P2 | Suspicious URL Communication
MITRE: T1204 - User Execution
Objective: Detect suspicious external URL access by CKYC host/users
Method: KQL based detection on URL + process behavior
Severity: High
Schedule: Every 5 minutes
```

---

## üîù Want pro version with EQL (more advanced)?

I can also give you **EQL version** that detects:

* User clicks ‚Üí Browser opens ‚Üí External suspicious domain hits

Just reply:
**"Give me EQL version for T1204 Suspicious URL rule"**

---

If you want, next I‚Äôll create:

‚úÖ T1078 ‚Äì Valid account abuse
‚úÖ T1110 ‚Äì Brute force
‚úÖ T1059 ‚Äì PowerShell abuse
‚úÖ T1566 ‚Äì Phishing attempt

Just say **‚ÄúCreate more CKYC SIEM rules‚Äù**
